# `String a = new String("a")` 和 `String a = "a"` 的区别

这两个字符串创建方式在Java中有重要区别，主要体现在内存分配和字符串常量池机制上。

## 1. 内存分配方式不同

### `String a = "a"`

- **使用字符串常量池**：
    
    - 字面量创建方式会首先检查字符串常量池中是否存在"a"
        
    - 如果存在，直接返回池中的引用
        
    - 如果不存在，在池中创建并返回引用
        
- **特点**：
    
    - 节省内存（重复使用相同字面量）
        
    - 创建速度快（避免重复创建）
        

### `String a = new String("a")`

- **显式创建新对象**：
    
    - 无论常量池是否存在"a"，都会在堆内存中创建一个新的String对象
        
    - 同时会将"a"放入字符串常量池（如果池中不存在）
        
- **特点**：
    
    - 每次都会创建新对象，占用更多内存
        
    - 创建速度稍慢
        

## 2. 对象数量不同

java

复制

下载

String s1 = "a";
String s2 = "a";
String s3 = new String("a");
String s4 = new String("a");

- 内存中对象情况：
    
    - 字符串常量池：1个"a"对象（被s1和s2共享）
        
    - 堆内存：2个独立String对象（s3和s4各自指向不同对象）
        

## 3. 比较结果不同

java

复制

下载

System.out.println(s1 == s2); // true（指向常量池同一对象）
System.out.println(s1 == s3); // false（s3是堆中新对象）
System.out.println(s3 == s4); // false（两个不同堆对象）
System.out.println(s1.equals(s3)); // true（内容相同）

## 4. 内存示意图

text

复制

下载

字符串常量池
+-----+
| "a" | <---- s1, s2
+-----+

堆内存
+---------------+
| String("a")   | <---- s3
+---------------+
| String("a")   | <---- s4
+---------------+

## 最佳实践建议

1. **优先使用字面量方式**（`String a = "a"`）：
    
    - 更高效
        
    - 更节省内存
        
2. **避免不必要的`new String()`**：
    
    - 除非确实需要新对象
        
    - 例如：`new String("a").intern()`可以强制使用常量池
        
3. **注意字符串拼接**：
    
    - 编译期确定的字面量拼接会优化
        
    - 运行期拼接会创建新对象
        

理解这些区别对于编写高效、内存友好的Java程序非常重要，特别是在处理大量字符串时。